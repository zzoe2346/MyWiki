---
tags:
  - concurency
  - java
created: 2025-07-27
---
java에서 일반적인 컬렉션 클래스인 HashMap, HashSet을 여러 스레드가 변경할 경우 데이터가 깨질 가능성이 존재한다. 이 문제를 해결하는 방법중 하나는 **동기화된 컬렉션을 사용하는것.**

java의 Collections Class는 동기화된 컬렉션을 생성하는 메서드를 제공. 한번에 한 스레드만 접근하도록 락을 써줌.

```
Map<String, String> map = new HashMap<>();
//동기화된 컬렉션 개체 생성
Map<String, String> syncMap = Collections.synchronizedMap(map);
```


> [!NOTE] Java23 이전 기준 가상스레드 사용시 주의점
> Java23 이전 기준 가상스레드 사용한다면 동기화 컬렉션 객체로 변환해주는 메서드 사용하면 안됨. 내부적으로 synchronized 사용해서 동시 접근을 동기화 하기 때문. 자바 23 또는 이전 버전 기준으로 가상 스레드는 아직 synchronized 지원않해서 가상 스레드 환경에서 Collections.synchronized()로 생성한 동기화 컬렉션 사용하면 성능에 문제 생길 가능성이 있음.

또다른 방법으로 동시성 자체를 지원하는 컬렉션 타입을 쓰는 것. 예를 들어 HashMap 대시 ConcurrentHashMap을 쓰는 것.

ConcurrentHashMap은 데이터 변경시 잠금 범위를 최소화한다. 따라서 키의 해시 분포가 고르고 동시 수정이 많다면, 동기화된 맵 사용하는것보다 더 나은 성능 제공



